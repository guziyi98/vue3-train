{
  "version": 3,
  "sources": ["../../shared/src/index.ts", "../src/effect.ts", "../src/baseHandlers.ts", "../src/reactive.ts", "../src/index.ts"],
  "sourcesContent": ["\n\nexport function isObject (value) {\n  return value !== null && typeof value === 'object'\n}", "\nexport let activeEffect\nclass ReactiveEffect {\n  public active = true\n  public deps = []\n  public parent = undefined\n  constructor(public fn) {\n    this.fn = fn\n  }\n  run () {\n    if (!this.active) {\n      return this.fn() // \u76F4\u63A5\u6267\u884C\u6B64\u51FD\u6570\u5373\u53EF\n    }\n    // \u5176\u4ED6\u60C5\u51B5\u4E0B \u610F\u5473\u7740\u662F\u6FC0\u6D3B\u72B6\u6001\n    try {\n      this.parent = activeEffect\n      activeEffect = this\n      return this.fn() // \u4F1A\u53D6\u54CD\u5E94\u5F0F\u7684\u5C5E\u6027\n    } finally {\n      activeEffect = this.parent\n      this.parent = undefined\n    }\n  }\n}\n// \u4F9D\u8D56\u6536\u96C6 \u5C31\u662F\u5C06\u5F53\u524D\u7684effect\u53D8\u6210\u5168\u5C40\u7684 \u7A0D\u540E\u53D6\u503C\u7684\u65F6\u5019\u53EF\u4EE5\u62FF\u5230\u8FD9\u4E2A\u5168\u5C40\u7684effect\nexport function effect (fn) {\n  const _effect = new ReactiveEffect(fn)\n  _effect.run() // \u9ED8\u8BA4\u8BA9\u54CD\u5E94\u5F0F\u7684effect\u6267\u884C\u4E00\u6B21\n}\n\n// let mapping = {\n//   target: {\n//     name: [activeEffect, activeEffect, activeEffect]\n//   }\n// }\nconst targetMap = new WeakMap()\nexport function track (target, key) {\n  if (!activeEffect) {\n    // \u53D6\u503C\u64CD\u4F5C\u6CA1\u6709\u53D1\u751F\u5728effect\u4E2D\n    return\n  }\n  debugger;\n  let depsMap = targetMap.get(target)\n  if (!depsMap) {\n    // weakMap\u4E2D\u7684key\u53EA\u80FD\u662F\u5BF9\u8C61\n    targetMap.set(target, (depsMap = new Map()))\n  }\n  let dep = depsMap.get(key)\n  if (!dep) {\n    depsMap.set(key, (dep = new Set()))\n  }\n  let shouldTrack = !dep.has(activeEffect)\n  if (shouldTrack) {\n    dep.add(activeEffect)\n    activeEffect.deps.push(dep) // \u540E\u7EED\u9700\u8981\u901A\u8FC7effect\u6765\u6E05\u7406\u7684\u65F6\u5019\u53EF\u4EE5\u53BB\u4F7F\u7528\n    // \u4E00\u4E2A\u5C5E\u6027\u5BF9\u5E94\u591A\u4E2Aeffect, \u4E00\u4E2Aeffect\u5BF9\u5E94\u7740\u591A\u4E2A\u5C5E\u6027\n    // \u5C5E\u6027\u548Ceffect\u7684\u5173\u7CFB\u662F\u591A\u5BF9\u591A\n  }\n}", "import { activeEffect, track } from './effect';\nimport { ReactiveFlags } from './reactive';\n\nexport const mutTableHandlers = {\n  get (target, key, receiver) {\n    if (ReactiveFlags.IS_REACTIVE === key) {\n      return target\n    }\n    track(target, key)\n    return Reflect.get(target, key, receiver) // \u5904\u7406\u4E86this\u6307\u5411\u95EE\u9898 \n  },\n  set (target, key, value, receiver) {\n    return Reflect.set(target, key, value, receiver)\n  }\n}", "\nimport { isObject } from '@vue/shared';\nimport { mutTableHandlers } from './baseHandlers';\n\nexport const enum ReactiveFlags {\n  IS_REACTIVE = '__v_isReactive'\n}\n\n\n\nconst reactiveMap = new WeakMap()\nexport function reactive (target) {\n  // typeof object\u5165\u53C2\u53EA\u80FD\u662F\u5BF9\u8C61 \n  if(!isObject(target)) {\n    return target\n  }\n  if (target[ReactiveFlags.IS_REACTIVE]) {\n    return target\n  }\n  // \u7F13\u5B58\u4E0B\u4EE3\u7406\u8FC7\u7684obj\uFF0C\u4E0B\u6B21\u518D\u8FDB\u884C\u4EE3\u7406\u7684\u65F6\u5019\u76F4\u63A5\u62FF\u51FA\u6765\u7528\n  const existsProxy = reactiveMap.get(target)\n  if (existsProxy) {\n    return existsProxy\n  }\n\n  const proxy = new Proxy(target, mutTableHandlers)\n  return proxy\n}", "import { isObject } from '@vue/shared';\nexport * from './effect'\nexport * from './reactive'\nexport default isObject"],
  "mappings": ";AAEO,SAAS,SAAU,OAAO;AAC/B,SAAO,UAAU,QAAQ,OAAO,UAAU;AAC5C;;;ACHO,IAAI;AACX,IAAM,iBAAN,MAAqB;AAAA,EAInB,YAAmB,IAAI;AAAJ;AAHnB,SAAO,SAAS;AAChB,SAAO,OAAO,CAAC;AACf,SAAO,SAAS;AAEd,SAAK,KAAK;AAAA,EACZ;AAAA,EACA,MAAO;AACL,QAAI,CAAC,KAAK,QAAQ;AAChB,aAAO,KAAK,GAAG;AAAA,IACjB;AAEA,QAAI;AACF,WAAK,SAAS;AACd,qBAAe;AACf,aAAO,KAAK,GAAG;AAAA,IACjB,UAAE;AACA,qBAAe,KAAK;AACpB,WAAK,SAAS;AAAA,IAChB;AAAA,EACF;AACF;AAEO,SAAS,OAAQ,IAAI;AAC1B,QAAM,UAAU,IAAI,eAAe,EAAE;AACrC,UAAQ,IAAI;AACd;AAOA,IAAM,YAAY,oBAAI,QAAQ;AACvB,SAAS,MAAO,QAAQ,KAAK;AAClC,MAAI,CAAC,cAAc;AAEjB;AAAA,EACF;AACA;AACA,MAAI,UAAU,UAAU,IAAI,MAAM;AAClC,MAAI,CAAC,SAAS;AAEZ,cAAU,IAAI,QAAS,UAAU,oBAAI,IAAI,CAAE;AAAA,EAC7C;AACA,MAAI,MAAM,QAAQ,IAAI,GAAG;AACzB,MAAI,CAAC,KAAK;AACR,YAAQ,IAAI,KAAM,MAAM,oBAAI,IAAI,CAAE;AAAA,EACpC;AACA,MAAI,cAAc,CAAC,IAAI,IAAI,YAAY;AACvC,MAAI,aAAa;AACf,QAAI,IAAI,YAAY;AACpB,iBAAa,KAAK,KAAK,GAAG;AAAA,EAG5B;AACF;;;ACvDO,IAAM,mBAAmB;AAAA,EAC9B,IAAK,QAAQ,KAAK,UAAU;AAC1B,+CAAkC,KAAK;AACrC,aAAO;AAAA,IACT;AACA,UAAM,QAAQ,GAAG;AACjB,WAAO,QAAQ,IAAI,QAAQ,KAAK,QAAQ;AAAA,EAC1C;AAAA,EACA,IAAK,QAAQ,KAAK,OAAO,UAAU;AACjC,WAAO,QAAQ,IAAI,QAAQ,KAAK,OAAO,QAAQ;AAAA,EACjD;AACF;;;ACVO,IAAW,gBAAX,kBAAWA,mBAAX;AACL,EAAAA,eAAA,iBAAc;AADE,SAAAA;AAAA,GAAA;AAMlB,IAAM,cAAc,oBAAI,QAAQ;AACzB,SAAS,SAAU,QAAQ;AAEhC,MAAG,CAAC,SAAS,MAAM,GAAG;AACpB,WAAO;AAAA,EACT;AACA,MAAI,OAAO,qCAA4B;AACrC,WAAO;AAAA,EACT;AAEA,QAAM,cAAc,YAAY,IAAI,MAAM;AAC1C,MAAI,aAAa;AACf,WAAO;AAAA,EACT;AAEA,QAAM,QAAQ,IAAI,MAAM,QAAQ,gBAAgB;AAChD,SAAO;AACT;;;ACxBA,IAAO,cAAQ;",
  "names": ["ReactiveFlags"]
}
